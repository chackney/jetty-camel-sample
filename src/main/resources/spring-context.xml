<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:camel="http://camel.apache.org/schema/spring"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.2.xsd
                           http://camel.apache.org/schema/spring http://camel.apache.org/schema/spring/camel-spring-2.11.0.xsd
                           http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd">

    <bean name="embeddedServletContainerFactory" class="org.springframework.boot.context.embedded.jetty.JettyEmbeddedServletContainerFactory"   />


    <bean name="helloWorldRoute" class="org.muckingabout.routes.HelloWorldRoot" />
    <bean name="dodgyRoute" class="org.muckingabout.routes.HystrixRoute" />

    <!-- Declare a Camel context -->
    <!-- By defining this in a Spring XML file, Camel uses the ApplicationContextRegistry by default -->
    <camel:camelContext id="camel-server" allowUseOriginalMessage="false">
        <!-- Routes -->
        <camel:routeBuilder ref="helloWorldRoute"/>
        <camel:routeBuilder ref="dodgyRoute" />
    </camel:camelContext>

    <bean name="hystrixServlet" class="com.netflix.hystrix.contrib.metrics.eventstream.HystrixMetricsStreamServlet" />
    <bean name="hystrixServletRegistrationBean" class="org.springframework.boot.context.embedded.ServletRegistrationBean" >
        <constructor-arg name="servlet" ref="hystrixServlet" />
        <constructor-arg name="urlMappings" value="/hystrix.stream" />
    </bean>


    <bean name="camelHttpTransportServlet" class="org.apache.camel.component.servlet.CamelHttpTransportServlet" />
    <bean name="camelServletRegistrationBean" class="org.springframework.boot.context.embedded.ServletRegistrationBean" >
        <constructor-arg name="servlet" ref="camelHttpTransportServlet" />
        <constructor-arg name="urlMappings" value="/*" />
    </bean>

    <context:component-scan base-package="org.muckingabout"  />
</beans>